---
description: Project Collaboration Playbook - Defines the project lifecycle as a State Machine.
globs: "**/*"
alwaysApply: true
---

# Project Collaboration Playbook (V4.0 - Prometheus Edition)

This document defines the **Project Lifecycle State Machine**.
The AI must explicitly identify the current state and execute the corresponding protocol.

## ðŸ”„ State Machine Definitions

### ðŸŸ¢ State 1: Bootstrapping (Initialization)
**Trigger**: New project start, or significant architecture overhaul.
**Protocol**:
1.  **Goal Definition**: User states the "North Star" goal.
2.  **Framework Check**: AI verifies existence of `src`, `docs`, `tasks`, `.cursor/rules`.
3.  **Map Creation**: AI generates `docs/project-map.md` (Detailed) and `.cursor/rules/project-map-summary.mdc` (Summary).
4.  **Exit Condition**: User confirms the initial map and structure.

### ðŸ”µ State 2: Development (Agile Loop)
**Trigger**: Routine feature development or tasks.
**Protocol**:
1.  **Task Definition**: User defines a task.
2.  **Plan `<thinking>`**: AI breaks down task, updates `tasks/[TODO]...`.
3.  **Execution**: AI modifies code/docs.
4.  **Verification**: AI runs lints/tests.
5.  **Exit Condition**: Task marked as `[DONE]`.

### ðŸŸ  State 3: Maintenance (Refactoring & Fixes)
**Trigger**: Bug reports, tech debt cleanup, or library upgrades.
**Protocol**:
1.  **Diagnosis**: Use `code-maintainer.md` (The Detective).
2.  **Proposal**: Explain the fix before touching code.
3.  **Regression Check**: Update test cases.
4.  **Exit Condition**: Bug fixed AND regression test passed.

---

## ðŸ¤ Interaction Protocols

### 1. The "Commander's Intent"
*   **User** provides the *What* and *Why*.
*   **AI** figures out the *How* (Plan).
*   **Constraint**: AI must NEVER guess the *Why*. If unclear, ASK.

### 2. The "Map Integrity" Pact
*   Any change to file structure -> **Immediate** update to `project-map-summary.mdc`.
*   No "Hidden Files". If it's code, it must be mapped.

### 3. The "Memory Refresh"
*   **Trigger**: User says "Refresh Memory" or modifies `.cursor/rules`.
*   **Action**: AI acknowledges and re-scans the rules folder.
